[platformio]
default_envs = esp32s3

[env:esp32s3]
platform = espressif32@6.4.0
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
upload_speed = 921600

# Include paths
include_dir = include

# Build flags
build_flags =
    -D CORE_DEBUG_LEVEL=2
    -D DEBUG_ESP_PORT=Serial
    -std=c++17
    -O2
    -I.
    -Iinclude
    -Iconan-headers
    -D CONFIG_IDF_TARGET_ESP32S3=1

# Libraries
lib_deps =
    # FFT for beat detection
    kosme/arduinoFFT @ ^1.4.0

    # WiFi and async web server
    ottowinter/ESPAsyncWebServer-esphome @ ^3.1.0
    me-no-dev/AsyncTCP @ ^1.1.1

    # Display drivers
    adafruit/Adafruit SSD1306 @ ^2.5.7
    TM1637Display @ ^1.1.0

    # JSON handling (will be replaced by FlatBuffers)
    bblanchon/ArduinoJson @ ^6.21.2

    # MQTT (optional)
    knolleary/PubSubClient @ ^2.8.0

# Optimization flags
[env:esp32dev-release]
platform = espressif32@6.4.0
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags =
    -D CORE_DEBUG_LEVEL=0
    -O3
    -std=c++17

# Test environment (for development/debugging)
[env:esp32dev-debug]
platform = espressif32@6.4.0
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600
build_flags =
    -D CORE_DEBUG_LEVEL=5
    -g
    -O0
    -std=c++17
