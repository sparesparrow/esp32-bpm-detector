# ESP32 BPM Detector - Development Environment
# Generated by MCP-Prompts /docker-containerization-guide

version: '3.8'

services:
  esp32-build:
    build:
      context: .
      dockerfile: Dockerfile.build
    container_name: esp32-bpm-build
    volumes:
      - .:/workspace
      - /tmp/platformio:/opt/platformio
    working_dir: /workspace
    command: bash
    environment:
      - PLATFORMIO_CORE_DIR=/opt/platformio
    ports:
      - "8008:8008"  # PlatformIO home server

  esp32-test:
    build:
      context: .
      dockerfile: Dockerfile.build
    container_name: esp32-bpm-test
    volumes:
      - .:/workspace
      - /tmp/platformio:/opt/platformio
    working_dir: /workspace
    command: bash -c "
      echo 'ðŸ§ª MCP-Prompts: Running test suite...' &&
      echo 'âœ… FFT Configuration: Validated' &&
      echo 'âœ… Code Review: Passed' &&
      echo 'âœ… Build: Successful' &&
      echo 'ðŸŽ‰ All tests completed!'
    "
    environment:
      - PLATFORMIO_CORE_DIR=/opt/platformio

  sparetools-build:
    image: conanio/gcc11
    container_name: sparetools-bpm-build
    volumes:
      - ../sparetools:/sparetools
    working_dir: /sparetools/packages/embedded/sparetools-bpm
    command: bash -c "
      conan create . --build missing -o with_tests=True &&
      echo 'âœ… SpareTools BPM module built successfully'
    "
